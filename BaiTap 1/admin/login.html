<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../img/logoCPT.png">
    <link rel="stylesheet" href="../css/style_loginQT.css">
    <script src="https://kit.fontawesome.com/e06076012c.js" crossorigin="anonymous"></script>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <title>Quản lý cửa hàng bán máy tính NCC</title>
</head>

<body>
    <section class="bgimg main">
        <form id="lginQT" method="dialog">
            <div class="title">Đăng nhập</div>
            <div class="inp">
                <label for="taikhoan"><i class="fas fa-user"></i></label>
                <input type="text" name="taikhoan" id="tk" placeholder="Nhập tên đăng nhập..." required>
            </div>
            <div class="inp">
                <label for="matkhau"><i class="fas fa-lock"></i></label>
                <input type="password" name="matkhau" id="mk" placeholder="Nhập mật khẩu..." required>
            </div>
            <div class="miss-pass">
                <a href="../admin/misspass.html">Quên mật khẩu</a>
            </div>
            <input type="submit" value="Đăng nhập">
        </form>
    </section>
    <script>
        var list = JSON.parse(localStorage.getItem('Staff')) || 
        [
            {
            anhnv: "",
            emailnv: "",
            manv: 'admin',
            mknv: "123",
            quyen: "Quản lý",
            sdtnv: "",
            tennv: "",
            trangthai: "Hoạt động"
           }
        ];

        $("#lginQT").submit(function (event) {
            var taikhoan = $('#tk').val();
            var matkhau = $('#mk').val();
            debugger;
            for (x of list) {
                if ((taikhoan == x.manv && matkhau == x.mknv && x.quyen == "Quản lý" && x.trangthai == "Hoạt động")) {
                    var user = {
                        manv: x.manv,
                        tennv: x.tennv,
                        emailnv: x.emailnv,
                        sdtnv: x.sdtnv,
                        quyen: x.quyen,
                        mknv: x.mknv
                    };
                    localStorage.setItem('user', JSON.stringify(user));
                    window.location.href = "../admin/TongQuan.html";
                    break;
                }
                else if (taikhoan == x.manv && matkhau == x.mknv && x.quyen == "Nhân viên" && x.trangthai == "Hoạt động") {
                    var user = {
                        manv: x.manv,
                        tennv: x.tennv,
                        emailnv: x.emailnv,
                        sdtnv: x.sdtnv,
                        quyen: x.quyen,
                        mknv: x.mknv
                    };
                    localStorage.setItem('user', JSON.stringify(user));
                    window.location.href = "../admin/TongQuanNV.html";
                    break;
                }
                else if (taikhoan == x.manv && matkhau == x.mknv && x.trangthai == "Khóa") {
                    alert("Tài khoản hiện bị khóa! Vui lòng liên hệ quản lý!");
                    break;
                }
                else if (taikhoan != x.manv && matkhau != x.mknv) {
                    alert("Tên đăng nhập hoặc mật khẩu sai! Vui lòng nhập lại!");
                    break;
                }
            }
            event.preventDefault();
        });
    </script>
</body>

</html>